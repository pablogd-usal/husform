/* MÁRGENES DE IMPRESIÓN */
@page {
    size: A4;
    margin: 5mm !important;
}

/* Ajuste global del body y contenedores para respetar el margen */
@media print {
    body {
        margin: 0 !important;
        padding: 0 !important;
    }

    .container-fluid,
    .carta,
    .row,
    .col-10,
    .col-12 {
        margin: 0 !important;
        padding: 0 !important;
        width: 100% !important;
        max-width: 100% !important;
    }

    .carta {
        padding: 6mm !important;
    }
}

@media print {
    /* --- Global Print Styles --- */

    /* nunogallego@gmail.com */
    
    body {
        font-family: Arial, sans-serif; /* Specify a common, print-friendly font */
        color: black; /* Ensure text is black for readability */
        background-color: white; /* Force white background to save ink */
        -webkit-print-color-adjust: exact; /* Ensure background colors are printed */
        print-color-adjust: exact;
    }

    /* Reset default input/textarea styles for print */
    input,
    textarea,
    .form-control,
    .seleccionarCandidato,
    .seleccionarEnsayo,
    .descripcion {
        outline: none;
        border: none;
        background-color: transparent;
        color: black;
        font-size: 1rem;
    }

    /* Hide elements not relevant for printing */
    .botones,
    .btnImprimir,
    #checkboxMasculino,
    #checkboxFemenino,
    #sexo input[type="checkbox"],
    .diagnosticoTexto, /* Consider if you always want to hide this, or only specific cases */
    .justificacionEstudios {
        display: none !important;
        visibility: hidden !important; /* Adding visibility hidden for stronger hiding */
    }

    /* Force background colors to print for specific elements */
    .tituloParte0,
    .tituloParte1,
    .tituloParte2,
    .tituloParte3,
    .vista-impresion,
    .labelMomentoEvolutivo,
    .labelTipoMuestra,
    #vistaImpresion,
    #diagnosticoTexto,
    #otrosInputEvolutivo,
    #otrosInputMuestra,
    #marcadorMolecular,
    #ensayoClinicoTexto,
    #justificacionOtrosEstudiosTexto {
        background-color: #A9CBDB; /* Use inherit or set specific color if needed */
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        color-adjust: exact !important; /* Added for broader browser support */
    }

    .tituloParte2,
    .tituloParte3{
        margin-left: 1.4vw;
        margin-right: 1.3vw;
    }

    /* --- Layout & Spacing --- */
    .carta,
    .container-fluid,
    .row,
    .col-10 {
        width: 100%;
        max-width: 100%;
        padding: 0;
        margin: 0;
        box-shadow: none; /* Remove shadows for print */
        border-bottom: #f1f1f1 solid 1px; 
    }

    .carta {
        padding: 20px;
        margin-top: -50px; /* Specific adjustment */
    }
    .container-fluid {
        padding: 0 20px; /* Add some padding for readability */
    }

    /*.headerImg {
        max-width: 100%;
        height: auto;
    }*/

    @media print {
      .headerImg {
          max-width: 70% !important;
          margin: 0 auto 10px auto !important;
      }
    }

    @media print {
      .tituloFormularioPeticion {
          font-size: 1.3rem;
          font-weight: bold;
          text-align: center;
          margin-top: 4px;
          margin-bottom: 8px;
      }
    }


    /* Apply common font size to multiple elements */
    .nombre,
    .fechaNacimiento,
    .nHistoria,
    #sexoSeleccionado,
    .labelNombre,
    .labelHistoria,
    .labelFecha,
    .labelSexo,
    .labelSolicitante,
    .labelHospital,
    .labelEmail,
    .labelTelefono,
    .inputMedico,
    .inputHospital,
    .inputEmail,
    .inputTelefono,
    .inputMuestraa,
    .inputOtros,
    .inputEmr,
    .inputEnsayoClinico,
    .inputInfiltracion,
    .notasFinales,
    .inputMuestra,
    .otrosInput,
    #emrMarker {
        font-size: .9rem;
    }
    /* Override for specific larger fonts */
    .seleccionarEstudio {
        font-size: 14px;
    }

     .tituloFormulario {
      font-size: 0.8rem !important;
      line-height: 1.2 !important;
      }
    .tituloParte0,
    .tituloParte1,
    .tituloParte2,
    .tituloParte3 {
        font-size: 0.85rem;
        padding: .4vw .7vw 2px 4px;
    }
    .h4otrosEstudios {
        font-size: 20px;
        margin-left: -10px;
    }

    /* Specific margin adjustments */
    
    #sexoSeleccionado { margin-top: -5px; }
    
    .labelFechaExtraccion { margin-top: 10px; }
    
    .pDiagnostico,
    .pSospechaDiagnostico {
        display: block;
        margin-top: -20px;
    }
    .inputDiagnostico {
        margin-top: -46px;
        margin-left: 80px;
    }
    .inputSospechaDiagnostico {
        margin-top: -46px;
        margin-left: 155px;
    }
    .labelMomentoEvolutivo {
        display: inline-block;
        margin-right: 10px;
    }
    .otrosInput {
        margin-left: 300px; /* This conflicts with the other .otrosInput definition; reconsider if both are needed */
        margin-top: 20px;
        width: 200px;
    }
    .form-check-inline {
        display: inline-block;
        margin-right: 10px;
    }
    .labelInfiltracion { display: block; }
    .estudios { margin-top: 10px; }
    .labelEstudios {
        display: block;
        margin-top: -20px;
    }
    .dividirlosEn4 {
        width: 150%;
        margin-left: 420px;
        margin-top: -135px;
    }
    .descripcion {
        margin-top: -10px;
        margin-left: -20px;
    }
    .colDerecha { margin-left: 500px; }
    .labelFechaExtraccion,
    .labelMomentoEvolutivo,
    .labelTipoMuestra,
    .pFechaExtraccion {
        display: block;
    }
    .otrosInput {
        margin-left: -5px;
        width: 200px;
        margin-top: -10px;
    }
    .pFechaExtraccion {
        margin-top: 20px;
        margin-bottom: 5px;
        page-break-inside: avoid;
    }
    #diagnosticoTexto { margin-left: 4px; }

    .form-control {
        margin-bottom: -.4rem;
    }

    /* --- Specific Element Styling --- */
    .cuadrado {
        border: 2px solid black;
        margin: 10px 0;
        width: 100%;
    }

    .seleccionarEstudio {
        width: 90%;
        text-align: left;
        color: black;
        background: none;
        white-space: pre-wrap;
        word-wrap: break-word;
        height: auto;
        display: inline-block;
        line-height: 1.5;
        margin: .1vw;
        
    }

    .btn.dropdown-toggle.seleccionarEstudio {
        width: 65%;
        text-align: left;
        white-space: normal;
        word-wrap: break-word;
    }

    #dropdownBtn {
        color: black;
    }

    #textoSeleccionado {
        margin-left: -10px;
        width: 100%;
        max-width: none;
        white-space: normal;
        word-wrap: break-word;
        overflow-wrap: break-word;
        display: block;
        visibility: visible;
        page-break-inside: avoid;
    }

    .radioDiagnostico,
    .radioSospecha,
    .radioDiagnosticoMmento,
    .radioRecaida,
    .radioEmr,
    .radioEvolutivo,
    .radioOtros,
    .checkboxSp,
    .checkboxMo,
    .checkboxGanglio,
    .checkboxParafina,
    .checkboxTejidos,
    .checkboxLiquido,
    .checkboxClonalidadB,
    .checkboxClonalidadT,
    .checkboxMieloide,
    .checkboxLinfoide,
    .checkboxMutaciones,
    .checkboxExon {
        transform: scale(0.7); /* Scale down radio/checkboxes for print */
        -webkit-transform: scale(0.7);
        -moz-transform: scale(0.7);
    }

    .form-check-input[type="radio"],
    .form-check-input[type="checkbox"] {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        width: 15px;
        height: 15px;
        border: 2px solid #000;
        border-radius: 50%; /* Radios are round */
        margin-right: 5px;
        position: relative;
        vertical-align: middle;
        background-color: #fff;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        color-adjust: exact;
    }

    .form-check-input[type="checkbox"] {
        border-radius: 3px; /* Checkboxes are square */
    }

    .form-check-input[type="radio"]:checked::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 6px;
        height: 6px;
        background-color: #000;
        border-radius: 50%;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        color-adjust: exact;
    }

    .form-check-input[type="checkbox"]:checked::before {
        content: "✓";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 12px;
        color: #000;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        color-adjust: exact;
    }

    @media print {

  /* Mostrar solo las opciones marcadas (radios y checkboxes) */

  /* Ocultar por completo inputs no seleccionados y sus etiquetas */
  .form-check-input[type="radio"]:not(:checked),
  .form-check-input[type="radio"]:not(:checked) + .form-check-label,
  .form-check-input[type="checkbox"]:not(:checked),
  .form-check-input[type="checkbox"]:not(:checked) + .form-check-label {
    display: none !important;
  }

  /* Para los que SÍ están marcados: escondemos la cajita del input y dejamos solo el texto del label */
  .form-check-input[type="radio"]:checked,
  .form-check-input[type="checkbox"]:checked {
    position: absolute !important;
    opacity: 0 !important;
    width: 0 !important;
    height: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
  }
}


    .form-check-label {
        vertical-align: middle;
        margin-left: 5px;
    }

    .textito {
        display: flex !important;
        flex-direction: column;
        gap: 4px;
        width: 100%;
        margin: 0;
        padding: 0;
        max-width: none;
    }

    .textito .estudio-item {
        margin-bottom: 2px;
        flex: none !important;
    }

    #justificacionOtrosEstudiosTexto {
        width: 100%;
        min-height: 120px;
        padding: 10px;
        font-size: 14px;
        font-family: Arial, sans-serif;
        line-height: 1.5;
        white-space: pre-wrap;
        word-wrap: break-word;
        overflow-wrap: break-word;
        background-color: transparent;
    }

    /* Common styling for transparent backgrounds */
    .otrosInput,
    .inputMuestra,
    #ensayoClinicoDetalles {
        background-color: transparent;
    }

    /* Specific styling for grey backgrounds on print */
    .form-control#otrosInputEvolutivo,
    .form-control#otrosInputMuestra,
    .form-control#ensayoClinicoTexto,
    .form-control#justificacionOtrosEstudiosTexto,
    #diagnosticoTexto,
    #marcadorMolecular {
        background-color: #f1f1f1;
        border: none;
        padding: 8px;
        margin: 0;
        margin-top: 10px;
        margin-bottom: 10px;
        display: block;
        box-sizing: border-box;
        height: auto;
        /* Removed transition and focus styles as they are not relevant for print */
    }

    @media print {
        /* Mantener Candidato y Ensayo en la misma línea solo en esa fila */
        .row.mb-3.tratamiento-row {
            display: flex !important;
            flex-wrap: nowrap !important;
            align-items: flex-start !important;
        }

        .row.mb-3.tratamiento-row > .col-6 {
            flex: 0 0 50% !important;
            max-width: 50% !important;
        }

        .row.mb-3.tratamiento-row .seleccionarCandidato,
        .row.mb-3.tratamiento-row .seleccionarEnsayo {
            display: inline-block !important;
            width: 100% !important;
            margin-bottom: 0 !important;
        }

        /*Reducir tamaño candidato y ensayo*/
        .seleccionarCandidato,
        .seleccionarEnsayo,
        #textoSeleccionadoEnsayoClinico,
        #ensayoClinicoTexto {
            font-size: 0.65rem !important;
            line-height: 1.1 !important;
            padding: 2px 4px !important;
        }

        /*Reducir tamaño botón desplegable*/
        #dropdownCandidato,
        #dropdownEnsayo {
            font-size: 0.75rem !important;
            padding: 2px 6px !important;
        }
    }


    @media print {
        /* Reducir un punto el tamaño de fuente en las secciones iniciales */
        .tituloParte0,
        .tituloParte1,
        .tituloParte2,
        .labelNombre,
        .labelHistoria,
        .labelFecha,
        .labelSexo,
        .labelSolicitante,
        .labelHospital,
        .labelEmail,
        .labelTelefono,
        .labelFechaExtraccion,
        .labelMomentoEvolutivo,
        .labelTipoMuestra,
        .form-control.nombre,
        .form-control.inputMedico,
        .form-control.inputHospital,
        .form-control.inputEmail,
        .form-control.inputTelefono,
        .form-control.inputFechaExtraccion,
        .form-control.inputInfiltracion,
        #otrosInputEvolutivo,
        #otrosInputMuestra,
        #marcadorMolecular {
            font-size: 0.85rem !important; /* antes 0.9rem */
            line-height: 1.1;
        }
    }  

    @media print {
        /* Reducir 2 puntos la letra en todo el apartado "Solicitud de estudios" */
        .tituloParte3,
        .colEstudiosProtocolizados,
        .colOtrosEstudios,
        #textoSeleccionado,
        #justificacionOtrosEstudiosTexto,
        .dropdown-menu .dropdown-item {
            font-size: 0.75rem !important; /* antes aprox. 0.9rem → baja 2pt */
            line-height: 1.2 !important;
        }

        /* Forzar que "Solicitud de estudios" empiece en la segunda página */
        .tituloParte3 {
            page-break-before: always !important;
            margin-top: 0.5cm !important;
        }

        /* Evita que su contenido se corte entre páginas */
        .colEstudiosProtocolizados,
        .colOtrosEstudios,
        #textoSeleccionado {
            page-break-inside: avoid !important;
        }
    }
}

/* Asterisco en labels, leyendas y botones que actúan como control */
.label-obligatorio::after,
.legend-obligatorio::after,
.btn-obligatorio::after {
  content: " *";
  color: #d00;
  font-weight: 700;
}

@media print {
  /* Mostrar los espejos y permitir salto de línea */
  .vista-impresion {
    display: block !important;
    white-space: normal !important;     /* permite múltiples líneas */
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    line-height: 1.2;                   /* cabe mejor en 2 renglones */
  }

  /* Ocultar el input en la hoja impresa */
  .nombre { 
    display: none !important;
  }
}

@media print {
  .vista-impresion {
    display: block !important;
    white-space: normal !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    line-height: 1.2;
  }

  /* ocultar inputs en el volante impreso */
  .inputMedico,
  .inputHospital,
  .inputEmail,
  .inputTelefono {
    display: none !important;
  }
}

@media print {

  /* Cada bloque ocupa todo el ancho de la página y se apilan */
  .colEstudiosProtocolizados,
  .colOtrosEstudios {
    display: block !important;
    float: none !important;
    width: 100% !important;
    max-width: 100% !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* Que otros estudios solo ocupe lo marcado */
  .colOtrosEstudios .form-check {
    margin: 0 !important;
    padding: 0 !important;
    min-height: 0 !important;  /* anula el min-height de bootstrap */
  }

  /* Bloque superior: estudios prot. */
  .colEstudiosProtocolizados {
    border: 1px solid #000;
    padding: 4px 6px;
    margin-bottom: 0.4cm;
  }

  #textoSeleccionado {
    margin-top: 4px !important;
    margin-bottom: 0 !important;
  }

  /* Bloque inferior: Ootros estudios */
  .colOtrosEstudios {
    border: 1px solid #000;
    padding: 4px 6px;
    margin-top: 0.1cm;
  }

  .colOtrosEstudios .pOtrosEstudios {
    margin-bottom: 4px;
  }

  .colOtrosEstudios .form-check {
    margin-bottom: 0;         
  }

  .colOtrosEstudios .form-check label {
    line-height: 1.1;
  }

  #justificacionOtrosEstudios {
    margin-top: 4px;
  }

  #justificacionOtrosEstudiosTexto {
    min-height: 40px !important;  
    height: auto !important;
    padding: 4px 6px;
  }

  #vistaJustificacion {
    margin-top: 2px;
  }
}


@media print {
  /* Reducir 3 puntos la letra y el interlineado en "Instrucciones y datos" */
  .textito {
    font-size: 12px !important;   /* antes 15px → baja 3 puntos */
    line-height: 1.2 !important;  /* interlineado más compacto */
    margin-top: 2mm;
  }

  /* Ajustar también el texto dentro si lo hubiera */
  .textito p,
  .textito li,
  .textito .estudio-item {
    font-size: 12px !important;
    line-height: 1.2 !important;
  }
}

/*  Ajuste de márgenes globales para impresión */
@page {
  size: A4;
  margin: 10mm 12mm 10mm 12mm;
}

@media print {
  /* Ajuste general del body */
  body {
    margin: 0 !important;
    padding: 0 !important;
  }

  /* Contenedor principal del formulario */
  .container,
  .container-fluid,
  .contenedor-principal {
    margin: 0 !important;
    padding: 4mm 6mm !important; 
    width: 100% !important;
  }

  /* Elimina márgenes de filas y columnas */
  .row {
    margin-right: 0 !important;
    margin-left: 0 !important;
  }
  [class*="col-"] {
    padding-right: 4px !important;
    padding-left: 4px !important;
  }

  @media print {
  /* Hemograma en una sola línea al imprimir */
  #inputsDiagnostico {
    display: flex !important;
    flex-wrap: nowrap !important;  
    align-items: flex-end !important;
    gap: 6pt !important;
    page-break-inside: avoid !important;
  }

  #inputsDiagnostico .hemo-field {
    display: flex !important;
    flex-direction: column !important;
    width: 80pt !important;         
  }

  #inputsDiagnostico .hemo-field label {
    margin: 0 0 2pt 0 !important;
    font-size: 9pt !important;
    line-height: 1.1 !important;
  }

  /* Ocultar en la impresión los campos de hemograma vacíos */
  #inputsDiagnostico .hemo-field.hemo-empty-print {
      display: none !important;
  }

  #inputsDiagnostico .hemo-field input {
    width: 100% !important;
    text-align: center !important;
    font-size: 9pt !important;
    line-height: 1.1 !important;
    padding: 2pt 4pt !important;
  }

  /* Plaquetas suele necesitar algo más de ancho */
  #inputsDiagnostico #plaquetasValor {
    width: 92% !important; /* dentro de su .hemo-field */
  }
}

@media print {
    /* Diagnóstico y justificación en recuadro, sin fondo azul */
    #vistaDiagnostico,
    #vistaJustificacion {
        background-color: transparent !important;
        border: 1px solid #000;
        padding: 4px 6px;
        margin-top: 6px;
        margin-bottom: 8px;
        border-radius: 3px;
    }
}

  @media print {
      /* Ocultar los mensajes de error */
      .error-msg,
      #errorGeneral,
      #errorMensaje,
      #errorMensajeMuestra,
      #err-posttx,
      #err-otros-muestra,
      [id^="err-hemo-"] {
          display: none !important;
          visibility: hidden !important;
          height: 0 !important;
          margin: 0 !important;
          padding: 0 !important;
      }
  }

  @media print {

    /* Mostrar input y texto de infiltración en una sola línea */
    #bloqueInfiltracion {
        display: none !important;
        align-items: center !important;
        gap: 10px !important;
        visibility: hidden !important;
    }

    #bloqueInfiltracion .inputInfiltracion {
        width: 60px !important;   /* tamaño compacto para que el texto quepa */
        margin: 0 !important;
    }

    #bloqueInfiltracion label {
        margin: 0 !important;
        padding: 0 !important;
        white-space: nowrap !important; /* Evita que el texto salte de línea */
    }
}

@media print {
    #codigoFormulario {
        text-align: center;
        font-size: 0.7rem;
        margin-top: 20px;
        color: #000;
        width: 100%;
        display: block;
        padding-top: 5px;
    }
}

@media print {

    #labAcepto,
    #labRechazo {
        transform: scale(0.8);
    }
}

/* Bloques que solo existen en la hoja impresa */
.solo-impresion {
    display: block !important;
}

/* Acepto / Rechazo */
.lab-opciones {
    display: flex;
    justify-content: flex-start;
    gap: 40px;         
    align-items: center;
}

.lab-opcion {
    font-size: 0.9rem;
    white-space: nowrap;
}

/* Espacio para anotaciones */
.lab-notas-linea {
    border-bottom: 1px solid #000;
    height: 18px;
    margin-top: 4px;
}

@media print {
  #textoSeleccionado {
    border: none !important;          
    background: transparent !important;
    padding: 0 !important;            
    margin-top: 4px !important;
    margin-bottom: 0 !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }
}

/* Quitar fondo azul en los datos del paciente y solicitante */
@media print {
    .vista-impresion {
        background-color: transparent !important;
    }
}

@media print {

    #logoJuntaImpresion {
        display: block !important;
        text-align: center;
        margin-top: 20px;
        page-break-inside: avoid;
    }

    .logoJuntaImg {
        width: 120px;       
        height: auto;
        margin: 0 auto;
        display: block;
    }
}

@media print {
  /* 'citogenética y biología molecular' centrado en la hoja de impresión */
  .carta h4:first-of-type {
      text-align: center !important;
      font-size: 1rem !important;
      margin-top: 2px !important;
      margin-bottom: 2px !important;
  }
}

  @media print {

      /* Igualar altura solo en la fila de datos inicial (paciente / solicitante) */
      .row.mt-2.fila-datos-inicial {
          display: flex !important;
          align-items: stretch !important;
          margin-bottom: 8px !important;  /* separación con el bloque de debajo */
      }

      .row.mt-2.fila-datos-inicial > .col-6 {
          display: flex !important;
      }

      .row.mt-2.fila-datos-inicial > .col-6 .cuadrado {
          flex: 1 1 auto !important;
          height: 100% !important;
          display: flex !important;
          flex-direction: column !important;
      }

      /* Separación inferior entre los recuadros superiores y el bloque siguiente */
      .fila-datos-inicial {
          margin-bottom: 10px !important;
          padding-bottom: 5px !important;
      }
  }

  @media print {

      /* La carta no ocupa todo el ancho físico de la hoja */
      .carta {
          max-width: 180mm !important;   /* algo más estrecha que el A4 (210mm) */
          margin: 0 auto !important;     /* centrada */
          padding-left: 6mm !important;
          padding-right: 6mm !important;
      }

      /* Títulos de secciones sin márgenes laterales extra */
      .tituloParte2,
      .tituloParte3 {
          margin-left: 0 !important;
          margin-right: 0 !important;
          width: 100% !important;
      }
  }


}

